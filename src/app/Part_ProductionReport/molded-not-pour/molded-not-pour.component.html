<div class="pagetitle" style="height: fit-content;">
  <i class="fa fa-play-circle mr-2" aria-hidden="true"></i>合模完成未澆注報表
</div>
<br>
<div style="width: 100%;height: 100%;">
  <ngb-tabset>
    <ngb-tab title="可合模" *ngIf="moldableData != undefined">
      <ng-template ngbTabContent>
        <button class="btn btn-info btn-sm active m-2" (click)="ExportMoldableData()"><i
          class="fa fa-file-excel-o mr-1"></i>可合模報表下載</button>
          <ng-container *ngFor="let key of keyMoldable">
            <B><h2>合模組別：{{key}}</h2></B>
            <table class="table tab_content_table table-bordered">
              <thead>
                <td>客戶</td>
                <td>產品</td>
                <td>產品規格</td>
                <td>數量</td>
                <td>單重</td>
                <td>總重</td>
                <td>預計合模日</td>
              </thead>
              <ng-container *ngFor="let item of moldableData[key]">
                <tr>
                  <td>{{item.Customer}}</td>
                  <td>{{item.Product}}</td>
                  <td>{{item.ProdDesc}}</td>
                  <td>{{item.Quantity}}</td>
                  <td>{{item.UnitWeight}}</td>
                  <td>{{item.TotalWeight}}</td>
                  <td>{{item.LastMoldDay}}</td>
                </tr>
              </ng-container>
            </table>
            <ng-container *ngIf="moldableGroupSummary != undefined">
              <div>目標產能：{{moldableGroupSummary[key].targetCapacity}}公斤&nbsp;&nbsp;
                   小計：{{moldableGroupSummary[key].qtySubtotal}}台&nbsp;&nbsp;
                   合計：{{moldableGroupSummary[key].totalWeightSum}}公斤&nbsp;&nbsp;
                   達成率：{{strip(moldableGroupSummary[key].achieveRate)}}%&nbsp;&nbsp;
                   可合模公斤數：{{moldableGroupSummary[key].remainingQty}}公斤</div>
              <br><br>
            </ng-container>
          </ng-container>
          <div><H1>當日可合模總公斤數：{{moldableWeightTotal}}&nbsp;&nbsp;&nbsp;當日可合模台數：{{moldableQtyTotal}}</H1></div>
      </ng-template>
    </ngb-tab>
    <ngb-tab title="可澆注" *ngIf="pourableData != undefined">
      <ng-template ngbTabContent>
        <button class="btn btn-info btn-sm active m-2" (click)="ExportPourableData()"><i
          class="fa fa-file-excel-o mr-1"></i>可澆注報表下載</button>
          <ng-container *ngFor="let key of keyPourable">
            <B><h2>合模組別：{{key}}</h2></B>
            <table class="table tab_content_table table-bordered">
              <thead>
                <td>客戶</td>
                <td>產品</td>
                <td>產品規格</td>
                <td>鐵斗資訊</td>
                <td>數量</td>
                <td>單重</td>
                <td>總重</td>
                <td>合模狀態</td>
                <td>合模完成日</td>
              </thead>
              <ng-container *ngFor="let item of pourableData[key]">
                <tr>
                  <td>{{item.Customer}}</td>
                  <td>{{item.Product}}</td>
                  <td>{{item.ProdDesc}}</td>
                  <td>{{item.Flask}}</td>
                  <td>{{item.Quantity}}</td>
                  <td>{{item.UnitWeight}}</td>
                  <td>{{item.TotalWeight}}</td>
                  <td>{{item.AssemblyStatus}}</td>
                  <td>{{item.LastMoldDay}}</td>
                </tr>
              </ng-container>
            </table>
            <ng-container *ngIf="pourableGroupSummary != undefined">
              <div>目標產能：{{pourableGroupSummary[key].targetCapacity}}公斤&nbsp;&nbsp;
                   小計：{{pourableGroupSummary[key].qtySubtotal}}台&nbsp;&nbsp;
                   合計：{{pourableGroupSummary[key].totalWeightSum}}公斤&nbsp;&nbsp;
                   達成率：{{strip(pourableGroupSummary[key].achieveRate)}}%&nbsp;&nbsp;</div>
              <br><br>
            </ng-container>
          </ng-container>
          <br><br>
          <div><H1>當日合模進站總公斤數：{{asemInQtySum}}&nbsp;&nbsp;前日未澆注總公斤數：{{asemPrevNotPourSum}}&nbsp;&nbsp;當日未澆注總公斤數：{{asemCurrentNotPourSum}}&nbsp;&nbsp;總達成率：{{strip(achieveRate)}}%&nbsp;&nbsp;</H1></div>
          <div><H1>總重公斤數加總：{{TotalWeightSumPour}}</H1></div>
      </ng-template>
    </ngb-tab>
  </ngb-tabset>
</div>

